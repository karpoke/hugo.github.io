#!/bin/bash
# Pre-commit hook para validar el build de Hugo
# Este hook se ejecuta antes de cada commit para asegurar que el sitio se puede generar

echo "üîç Pre-commit hook: Validando build de Hugo..."

# Verificar que Hugo est√° instalado
if ! command -v hugo &> /dev/null; then
    echo "‚ùå Error: Hugo no est√° instalado"
    echo "   Instala Hugo desde: https://gohugo.io/installation/"
    exit 1
fi

# Ejecutar hugo build para validar
if hugo --quiet --minify 2>&1 | tee /tmp/hugo-build.log; then
    echo "‚úÖ Build de Hugo exitoso"
    # Limpiar archivos generados (no queremos commitearlos)
    rm -rf public/ resources/
    exit 0
else
    echo "‚ùå Error: El build de Hugo fall√≥"
    echo ""
    echo "Errores encontrados:"
    cat /tmp/hugo-build.log
    echo ""
    echo "Por favor, corrige los errores antes de hacer commit."
    echo "Puedes ejecutar 'hugo --verbose' para m√°s detalles."
    exit 1
fi
